---
title: "Univariate Numerical Data"
author: "Alexandria Coombe"
format: 
  html: 
    embed-resources: true
    self-contained-math: true
---

```{r}
cannabisDataset <- read.csv("cannabisDataset.csv",
                        header = TRUE)
head(cannabisDataset)
```


```{r}
library(dplyr)
library(stringr)

cannabisDataset <- cannabisDataset %>%
  mutate_all(str_squish)

cannabisDataset <- cannabisDataset %>%
 mutate_all(~ifelse(tolower(.) %in% c("yes", "Yes"), 1, ifelse(tolower(.) %in% c("no", "No"), 0, .)))
```

```{r}
cannabisDataset <- cannabisDataset %>%
  group_by(States, year) %>%
  mutate(
    cannabisLiberalization = case_when( 
      decriminalizedMarijuana == 1 & legalizedMedicinalMarijuana == 0 & legalizedRecreationalMarijuana == 0 ~ "Decriminalized",
      decriminalizedMarijuana == 0 & legalizedMedicinalMarijuana == 1 & legalizedRecreationalMarijuana == 0 ~ "Medicinal",
      decriminalizedMarijuana == 0 & legalizedMedicinalMarijuana == 0 & legalizedRecreationalMarijuana == 1 ~ "Recreational",
      decriminalizedMarijuana == 1 & legalizedMedicinalMarijuana == 1 & legalizedRecreationalMarijuana == 1 ~ "Fully Legal",
      decriminalizedMarijuana == 0 & legalizedMedicinalMarijuana== 0 & legalizedRecreationalMarijuana == 0 ~ "Fully Illegal",
      decriminalizedMarijuana == 1 & legalizedMedicinalMarijuana == 0 & legalizedRecreationalMarijuana == 1 ~ "Recreational & Decriminalized",
      decriminalizedMarijuana == 1 & legalizedMedicinalMarijuana == 1 & legalizedRecreationalMarijuana == 0 ~ "Decriminalized & Medicinal",
      decriminalizedMarijuana == 0 & legalizedMedicinalMarijuana == 1 & legalizedRecreationalMarijuana == 1 ~ "Medicinal & Recreational",
      TRUE ~ "None"
    )
  ) %>%

  select(-decriminalizedMarijuana, -legalizedMedicinalMarijuana, -legalizedRecreationalMarijuana)

head(cannabisDataset)
```


```{r}
cannabisDataset$crimeRate <- as.numeric(as.character(cannabisDataset$crimeRate))

cannabisDataset$recidivismRate <- as.numeric(as.character(cannabisDataset$recidivismRate))

cannabisDataset$population <- as.numeric(as.character(cannabisDataset$population))

cannabisDataset$alcoholism <- as.numeric(as.character(cannabisDataset$alcoholism))

cannabisDataset$unemploymentRate <- as.numeric(as.character(cannabisDataset$unemploymentRate))

cannabisDataset$medianHouseholdIncome <- as.numeric(as.character(cannabisDataset$medianHouseholdIncome))
```

```{r}
cannabisData2020 <- subset(cannabisDataset, year == 2020)
```

```{r}
length(unique(cannabisData2020$crimeRate))
summary(cannabisData2020$crimeRate)
```


```{r}
length(unique(cannabisData2020$unemploymentRate))
summary(cannabisData2020$unemploymentRate)
```


```{r}
library(ggplot2)
# ggplot(cannabisData2020, aes(x = crimeRate)) +
# 
#   # Create the histogram with custom bins
#   geom_histogram(binwidth = 20, fill = "skyblue", color = "black") +
# 
#   # Add title and subtitle
#   ggtitle("Crime Rate Distribution in 2020") +
#   labs(subtitle = "Distribution of crime rates across states and D.C.") +
# 
#   # Add axis labels
#   xlab("Crime Rate") +
#   ylab("Frequency") +
# 
#   # Customize the appearance of the plot
#   theme_minimal() +
# 
#   # Add a legend (optional)
#   scale_fill_manual(values = "skyblue", name = "Crime Rate")

ggplot(cannabisData2020, aes(x = crimeRate, y = after_stat(density))) +
    geom_histogram(binwidth = 20, fill = "skyblue", color = "black") +
    ggtitle("Crime Rate Distribution in 2020") +
  labs(subtitle = "Distribution of crime rates across states and D.C.") +
  xlab("Crime Rate") +
  ylab("Frequency") +
  theme_minimal() +
  scale_fill_manual(values = "skyblue", name = "Crime Rate")
```

```{r}
ggplot(cannabisData2020, aes(x = crimeRate)) +
  geom_histogram(binwidth = 80, fill = "skyblue", color = "black") +
  ggtitle("Crime Rate Distribution in 2020") +
  labs(subtitle = "Distribution of crime rates across states and D.C.",
       x = "Crime Rate",
       y = "Frequency") +
  annotate("text", x = 4250, y = 1.2, label = "highest rates are outliers") +
  theme_minimal()
```

```{r}
ggplot(cannabisData2020, aes(x = crimeRate)) +
  geom_histogram(binwidth = 80, fill = "darkolivegreen", color = "black") +
  ggtitle("Crime Rate Distribution in 2020") +
  labs(subtitle = "Distribution of crime rates across states and D.C.",
       x = "Crime Rate",
       y = "Frequency") +
  theme_minimal() +
  labs(title = "Crime Rate Distribution in 2020",
       subtitle = "Distribution of crime rates across states and D.C.",
       caption = "Source: cannabisData2020")
```


```{r}
numabsoluteT=table(cannabisData2020$unemploymentRate,
                exclude = 'nothing')
numabsoluteT
```

```{r}
numpropT=prop.table(numabsoluteT)*100

numpropT
```


```{r}

ggplot(cannabisData2020, aes(x = unemploymentRate)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  labs(title = "Unemployment Rates Across The United States",
       subtitle = "United States-2020",
       x = "Unemployment Rate",
       y = "Frequency of Unemployment Rate") +
   scale_x_continuous(labels = scales::percent_format(scale = 1))
```



```{r}
ggplot(cannabisData2020, aes(x = unemploymentRate)) +
  geom_histogram(binwidth = 1, fill = "skyblue", color = "black") +
  labs(title = "Unemployment Rates Across The United States",
       x = "Unemployment Rate",
       y = "Count") +
  facet_wrap(~ States)
```

```{r}
ggplot(cannabisData2020, aes(x = unemploymentRate)) +
  
  geom_histogram(binwidth = 5, fill = "hotpink", color = "black") +
  
  # Add title and axis labels
  labs(title = "Unemployment Rates Across The United States",
       x = "Unemployment Rate (%)",
       y = "Count") +
  
  # Facet by States and add subtitles
  facet_wrap(~ States) +
  labs(subtitle = "Distribution of unemployment rates in each state and D.C.") +
  
  # Customize the appearance of the plot
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 55, hjust = 1))

```


```{r}
  ggplot(cannabisData2020, aes(x = unemploymentRate)) +
  geom_histogram(binwidth = 0.5, fill = "hotpink", color = "black") +
  
  ggtitle("Unemployment Rates across the United States") +
  labs(subtitle = "United States-2020") +
  
  xlab("Unemployment Rate") +
  ylab("Frequency of Unemployment Rates 
       across the United States") +

  theme_classic() +
  scale_x_continuous(breaks = seq(0, max(cannabisData2020$unemploymentRate), by = 2)) 

```

